<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>Statistiche Annuali</title>

<style>
body {
  font-family: Arial, sans-serif;
}

/* HEADER */
.header {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 10px;
}

/* TAB */
.tabs {
  display: flex;
  border-bottom: 2px solid #ccc;
  margin-bottom: 5px;
}

.tab {
  padding: 10px 15px;
  cursor: pointer;
}

.tab.active {
  border-bottom: 3px solid #007bff;
  font-weight: bold;
}

/* CONTENUTO */
#content {
  width: 100%;
}

iframe {
  width: 100%;
  height: 900px;
  border: none;
}
.header-bar {
  display: flex;
  align-items: center;
}

.left,
.center,
.right {
  flex: 1;
}

.left {
  display: flex;
  align-items: center;
}

.center {
  text-align: center;
}

.right {
  text-align: right;
  font-size: 12px;
}

</style>

<script>
function initYearSelect(selectId, startYear) {
  const select = document.getElementById(selectId);
  if (!select) return;

  const now = new Date();
  const currentYear = now.getFullYear();
  const month = now.getMonth(); // 0 = gennaio

  // Regola di selezione
  const yearToSelect = (month === 0)
    ? currentYear - 1
    : currentYear;

  // Pulizia eventuali option già presenti
  select.innerHTML = "";

  // Popolamento combo
  for (let year = startYear; year <= currentYear; year++) {
    const option = document.createElement("option");
    option.value = year;
    option.textContent = year;

    if (year === yearToSelect) {
      option.selected = true;
    }

    select.appendChild(option);
  }
}

// Inizializzazione
document.addEventListener("DOMContentLoaded", function () {
  initYearSelect("selectYear", 2019);
});
</script>

</head>

<body>

<!-- HEADER COMUNE -->
<div class="header-bar">
  <div class="left">
  <a href="index.html">
    <img src="images/icons/home.png">
  </a>
  <select id="selectYear"></select>
  </div>

  <div class="center">
    <img src="images/loghi/statistiche_239x86.png" alt="logo">
  </div>

  <div class="right">
    <span id="lastUpdate">Ultimo aggiornamento: $data</span>
  </div>
</div>


<!-- TAB -->
<div class="tabs">
  <div class="tab active" data-tab="statisticheClub">Statistiche Club</div>
  <div class="tab" data-tab="statisticheAnnuali">Statistiche Pluriennali</div>
  <div class="tab" data-tab="statisticheGiocatori">Statistiche Giocatori</div>
</div>

<!-- CONTENUTO -->
<div id="content">
  <iframe id="tabFrame"></iframe>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {

  const tabs = document.querySelectorAll(".tab");
  const frame = document.getElementById("tabFrame");
  const yearSelect = document.getElementById("selectYear");

  // primo tab come default
  let activeTab = tabs[0].dataset.tab;

  function getTabUrl(tab) {
    const year = yearSelect.value;

    switch (tab) {
      case "statistichePluriennali":
        return "./STATISTICHE/statistichePluriennali.html";

      case "statisticheClub":
        return "./STATISTICHE/statisticheClub" + year + ".html";

      case "statisticheGiocatori":
        return "./STATISTICHE/statisticheGiocatori" + year + ".html";
    }
  }

  function loadTab(tab) {
    activeTab = tab;

    tabs.forEach(t =>
      t.classList.toggle("active", t.dataset.tab === tab)
    );

    frame.src = getTabUrl(tab);
  }

  // click sui tab
  tabs.forEach(tab => {
    tab.addEventListener("click", () => {
      loadTab(tab.dataset.tab);
    });
  });

  // cambio anno → ricarica il tab attivo
  yearSelect.addEventListener("change", () => {
    loadTab(activeTab);
  });

  // ✅ caricamento iniziale corretto
  loadTab(activeTab);
});
</script>


</body>
</html>
